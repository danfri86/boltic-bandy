function array_unique_noempty(e){var t=[];return jQuery.each(e,function(e,n){n=jQuery.trim(n),n&&-1==jQuery.inArray(n,t)&&t.push(n)}),t}var tagBox,commentsBox,editPermalink,makeSlugeditClickable,WPSetThumbnailHTML,WPSetThumbnailID,WPRemoveThumbnail,wptitlehint;!function(e){tagBox={clean:function(e){var t=postL10n.comma;return","!==t&&(e=e.replace(new RegExp(t,"g"),",")),e=e.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,""),","!==t&&(e=e.replace(/,/g,t)),e},parseTags:function(t){var n=t.id,r=n.split("-check-num-")[1],i=e(t).closest(".tagsdiv"),s=i.find(".the-tags"),o=postL10n.comma,u=s.val().split(o),f=[];return delete u[r],e.each(u,function(t,n){n=e.trim(n),n&&f.push(n)}),s.val(this.clean(f.join(o))),this.quickClicks(i),!1},quickClicks:function(t){var n,r,i=e(".the-tags",t),s=e(".tagchecklist",t),o=e(t).attr("id");i.length&&(r=i.prop("disabled"),n=i.val().split(postL10n.comma),s.empty(),e.each(n,function(t,n){var i,u;n=e.trim(n),n&&(i=e("<span />").text(n),r||(u=e('<a id="'+o+"-check-num-"+t+'" class="ntdelbutton">X</a>'),u.click(function(){tagBox.parseTags(this)}),i.prepend("&nbsp;").prepend(u)),s.append(i))}))},flushTags:function(t,n,r){var i,s,o,u=e(".the-tags",t),f=e("input.newtag",t),l=postL10n.comma;return n=n||!1,o=n?e(n).text():f.val(),i=u.val(),s=i?i+l+o:o,s=this.clean(s),s=array_unique_noempty(s.split(l)).join(l),u.val(s),this.quickClicks(t),n||f.val(""),"undefined"==typeof r&&f.focus(),!1},get:function(t){var n=t.substr(t.indexOf("-")+1);e.post(ajaxurl,{action:"get-tagcloud",tax:n},function(r,i){(0===r||"success"!=i)&&(r=wpAjax.broken),r=e('<p id="tagcloud-'+n+'" class="the-tagcloud">'+r+"</p>"),e("a",r).click(function(){return tagBox.flushTags(e(this).closest(".inside").children(".tagsdiv"),this),!1}),e("#"+t).after(r)})},init:function(){var t=this,n=e("div.ajaxtag");e(".tagsdiv").each(function(){tagBox.quickClicks(this)}),e("input.tagadd",n).click(function(){t.flushTags(e(this).closest(".tagsdiv"))}),e("div.taghint",n).click(function(){e(this).css("visibility","hidden").parent().siblings(".newtag").focus()}),e("input.newtag",n).blur(function(){""===this.value&&e(this).parent().siblings(".taghint").css("visibility","")}).focus(function(){e(this).parent().siblings(".taghint").css("visibility","hidden")}).keyup(function(t){return 13==t.which?(tagBox.flushTags(e(this).closest(".tagsdiv")),!1):void 0}).keypress(function(e){return 13==e.which?(e.preventDefault(),!1):void 0}).each(function(){var t=e(this).closest("div.tagsdiv").attr("id");e(this).suggest(ajaxurl+"?action=ajax-tag-search&tax="+t,{delay:500,minchars:2,multiple:!0,multipleSep:postL10n.comma+" "})}),e("#post").submit(function(){e("div.tagsdiv").each(function(){tagBox.flushTags(this,!1,1)})}),e("a.tagcloud-link").click(function(){return tagBox.get(e(this).attr("id")),e(this).unbind().click(function(){return e(this).siblings(".the-tagcloud").toggle(),!1}),!1})}},commentsBox={st:0,get:function(t,n){var r,i=this.st;return n||(n=20),this.st+=n,this.total=t,e("#commentsdiv .spinner").show(),r={action:"get-comments",mode:"single",_ajax_nonce:e("#add_comment_nonce").val(),p:e("#post_ID").val(),start:i,number:n},e.post(ajaxurl,r,function(t){return t=wpAjax.parseAjaxResponse(t),e("#commentsdiv .widefat").show(),e("#commentsdiv .spinner").hide(),"object"==typeof t&&t.responses[0]?(e("#the-comment-list").append(t.responses[0].data),theList=theExtraList=null,e("a[className*=':']").unbind(),commentsBox.st>commentsBox.total?e("#show-comments").hide():e("#show-comments").show().children("a").html(postL10n.showcomm),void 0):1==t?(e("#show-comments").html(postL10n.endcomm),void 0):(e("#the-comment-list").append('<tr><td colspan="2">'+wpAjax.broken+"</td></tr>"),void 0)}),!1}},WPSetThumbnailHTML=function(t){e(".inside","#postimagediv").html(t)},WPSetThumbnailID=function(t){var n=e('input[value="_thumbnail_id"]',"#list-table");n.size()>0&&e("#meta\\["+n.attr("id").match(/[0-9]+/)+"\\]\\[value\\]").text(t)},WPRemoveThumbnail=function(t){e.post(ajaxurl,{action:"set-post-thumbnail",post_id:e("#post_ID").val(),thumbnail_id:-1,_ajax_nonce:t,cookie:encodeURIComponent(document.cookie)},function(e){"0"==e?alert(setPostThumbnailL10n.error):WPSetThumbnailHTML(e)})},e(document).on("heartbeat-send.refresh-lock",function(t,n){var r=e("#active_post_lock").val(),i=e("#post_ID").val(),s={};i&&e("#post-lock-dialog").length&&(s.post_id=i,r&&(s.lock=r),n["wp-refresh-post-lock"]=s)}),e(document).on("heartbeat-tick.refresh-lock",function(t,n){var r,i,s;n["wp-refresh-post-lock"]&&(r=n["wp-refresh-post-lock"],r.lock_error?(i=e("#post-lock-dialog"),i.length&&!i.is(":visible")&&("function"==typeof autosave&&(e(document).on("autosave-disable-buttons.post-lock",function(){i.addClass("saving")}).on("autosave-enable-buttons.post-lock",function(){i.removeClass("saving").addClass("saved"),window.onbeforeunload=null}),autosave()||(window.onbeforeunload=null),autosave=function(){}),r.lock_error.avatar_src&&(s=e('<img class="avatar avatar-64 photo" width="64" height="64" />').attr("src",r.lock_error.avatar_src.replace(/&amp;/g,"&")),i.find("div.post-locked-avatar").empty().append(s)),i.show().find(".currently-editing").text(r.lock_error.text),i.find(".wp-tab-first").focus())):r.new_lock&&e("#active_post_lock").val(r.new_lock))})}(jQuery),function(e){function t(){n=!1,window.clearTimeout(r),r=window.setTimeout(function(){n=!0},3e5)}var n,r;e(document).on("heartbeat-send.wp-refresh-nonces",function(t,r){var i,s;n&&(s=e("#post_ID").val())&&(i=e("#_wpnonce").val())&&(r["wp-refresh-post-nonces"]={post_id:s,post_nonce:i})}).on("heartbeat-tick.wp-refresh-nonces",function(n,r){var i=r["wp-refresh-post-nonces"];i&&(t(),i.replace&&e.each(i.replace,function(t,n){e("#"+t).val(n)}),i.heartbeatNonce&&(window.heartbeatSettings.nonce=i.heartbeatNonce))}).ready(function(){t()})}(jQuery),jQuery(document).ready(function(e){var t,n,r,i,s="",o=0,u=e("#content");postboxes.add_postbox_toggles(pagenow),e("#post-lock-dialog .notification-dialog").on("keydown",function(t){if(9==t.which){var n=e(t.target);n.hasClass("wp-tab-first")&&t.shiftKey?(e(this).find(".wp-tab-last").focus(),t.preventDefault()):n.hasClass("wp-tab-last")&&!t.shiftKey&&(e(this).find(".wp-tab-first").focus(),t.preventDefault())}}).filter(":visible").find(".wp-tab-first").focus(),"undefined"!=typeof wp&&wp.heartbeat&&e("#post-lock-dialog").length&&wp.heartbeat.interval(15),e("#tagsdiv-post_tag").length?tagBox.init():e("#side-sortables, #normal-sortables, #advanced-sortables").children("div.postbox").each(function(){return 0===this.id.indexOf("tagsdiv-")?(tagBox.init(),!1):void 0}),e(".categorydiv").each(function(){var t,n,r,i,s,o=e(this).attr("id");r=o.split("-"),r.shift(),i=r.join("-"),s=i+"_tab","category"==i&&(s="cats"),e("a","#"+i+"-tabs").click(function(){var t=e(this).attr("href");return e(this).parent().addClass("tabs").siblings("li").removeClass("tabs"),e("#"+i+"-tabs").siblings(".tabs-panel").hide(),e(t).show(),"#"+i+"-all"==t?deleteUserSetting(s):setUserSetting(s,"pop"),!1}),getUserSetting(s)&&e('a[href="#'+i+'-pop"]',"#"+i+"-tabs").click(),e("#new"+i).one("focus",function(){e(this).val("").removeClass("form-input-tip")}),e("#new"+i).keypress(function(t){13===t.keyCode&&(t.preventDefault(),e("#"+i+"-add-submit").click())}),e("#"+i+"-add-submit").click(function(){e("#new"+i).focus()}),t=function(t){return e("#new"+i).val()?(t.data+="&"+e(":checked","#"+i+"checklist").serialize(),e("#"+i+"-add-submit").prop("disabled",!0),t):!1},n=function(t,n){var r,s=e("#new"+i+"_parent");e("#"+i+"-add-submit").prop("disabled",!1),"undefined"!=n.parsed.responses[0]&&(r=n.parsed.responses[0].supplemental.newcat_parent)&&(s.before(r),s.remove())},e("#"+i+"checklist").wpList({alt:"",response:i+"-ajax-response",addBefore:t,addAfter:n}),e("#"+i+"-add-toggle").click(function(){return e("#"+i+"-adder").toggleClass("wp-hidden-children"),e('a[href="#'+i+'-all"]',"#"+i+"-tabs").click(),e("#new"+i).focus(),!1}),e("#"+i+"checklist, #"+i+"checklist-pop").on("click",'li.popular-category > label input[type="checkbox"]',function(){var t=e(this),n=t.is(":checked"),r=t.val();r&&t.parents("#taxonomy-"+i).length&&e("#in-"+i+"-"+r+", #in-popular-"+i+"-"+r).prop("checked",n)})}),e("#postcustom").length&&e("#the-list").wpList({addAfter:function(){e("table#list-table").show()},addBefore:function(t){return t.data+="&post_id="+e("#post_ID").val(),t}}),e("#submitdiv").length&&(t=e("#timestamp").html(),n=e("#post-visibility-display").html(),r=function(){var t=e("#post-visibility-select");"public"!=e("input:radio:checked",t).val()?(e("#sticky").prop("checked",!1),e("#sticky-span").hide()):e("#sticky-span").show(),"password"!=e("input:radio:checked",t).val()?e("#password-span").hide():e("#password-span").show()},i=function(){if(!e("#timestampdiv").length)return!0;var n,r,i,s,o=e("#post_status"),u=e('option[value="publish"]',o),f=e("#aa").val(),l=e("#mm").val(),c=e("#jj").val(),h=e("#hh").val(),p=e("#mn").val();return n=new Date(f,l-1,c,h,p),r=new Date(e("#hidden_aa").val(),e("#hidden_mm").val()-1,e("#hidden_jj").val(),e("#hidden_hh").val(),e("#hidden_mn").val()),i=new Date(e("#cur_aa").val(),e("#cur_mm").val()-1,e("#cur_jj").val(),e("#cur_hh").val(),e("#cur_mn").val()),n.getFullYear()!=f||1+n.getMonth()!=l||n.getDate()!=c||n.getMinutes()!=p?(e(".timestamp-wrap","#timestampdiv").addClass("form-invalid"),!1):(e(".timestamp-wrap","#timestampdiv").removeClass("form-invalid"),n>i&&"future"!=e("#original_post_status").val()?(s=postL10n.publishOnFuture,e("#publish").val(postL10n.schedule)):i>=n&&"publish"!=e("#original_post_status").val()?(s=postL10n.publishOn,e("#publish").val(postL10n.publish)):(s=postL10n.publishOnPast,e("#publish").val(postL10n.update)),r.toUTCString()==n.toUTCString()?e("#timestamp").html(t):e("#timestamp").html(s+" <b>"+postL10n.dateFormat.replace("%1$s",e('option[value="'+e("#mm").val()+'"]',"#mm").text()).replace("%2$s",c).replace("%3$s",f).replace("%4$s",h).replace("%5$s",p)+"</b> "),"private"==e("input:radio:checked","#post-visibility-select").val()?(e("#publish").val(postL10n.update),0===u.length?o.append('<option value="publish">'+postL10n.privatelyPublished+"</option>"):u.html(postL10n.privatelyPublished),e('option[value="publish"]',o).prop("selected",!0),e(".edit-post-status","#misc-publishing-actions").hide()):("future"==e("#original_post_status").val()||"draft"==e("#original_post_status").val()?u.length&&(u.remove(),o.val(e("#hidden_post_status").val())):u.html(postL10n.published),o.is(":hidden")&&e(".edit-post-status","#misc-publishing-actions").show()),e("#post-status-display").html(e("option:selected",o).text()),"private"==e("option:selected",o).val()||"publish"==e("option:selected",o).val()?e("#save-post").hide():(e("#save-post").show(),"pending"==e("option:selected",o).val()?e("#save-post").show().val(postL10n.savePending):e("#save-post").show().val(postL10n.saveDraft)),!0)},e(".edit-visibility","#visibility").click(function(){return e("#post-visibility-select").is(":hidden")&&(r(),e("#post-visibility-select").slideDown("fast"),e(this).hide()),!1}),e(".cancel-post-visibility","#post-visibility-select").click(function(){return e("#post-visibility-select").slideUp("fast"),e("#visibility-radio-"+e("#hidden-post-visibility").val()).prop("checked",!0),e("#post_password").val(e("#hidden-post-password").val()),e("#sticky").prop("checked",e("#hidden-post-sticky").prop("checked")),e("#post-visibility-display").html(n),e(".edit-visibility","#visibility").show(),i(),!1}),e(".save-post-visibility","#post-visibility-select").click(function(){var t=e("#post-visibility-select");return t.slideUp("fast"),e(".edit-visibility","#visibility").show(),i(),"public"!=e("input:radio:checked",t).val()&&e("#sticky").prop("checked",!1),s=e("#sticky").prop("checked")?"Sticky":"",e("#post-visibility-display").html(postL10n[e("input:radio:checked",t).val()+s]),!1}),e("input:radio","#post-visibility-select").change(function(){r()}),e("#timestampdiv").siblings("a.edit-timestamp").click(function(){return e("#timestampdiv").is(":hidden")&&(e("#timestampdiv").slideDown("fast"),e("#mm").focus(),e(this).hide()),!1}),e(".cancel-timestamp","#timestampdiv").click(function(){return e("#timestampdiv").slideUp("fast"),e("#mm").val(e("#hidden_mm").val()),e("#jj").val(e("#hidden_jj").val()),e("#aa").val(e("#hidden_aa").val()),e("#hh").val(e("#hidden_hh").val()),e("#mn").val(e("#hidden_mn").val()),e("#timestampdiv").siblings("a.edit-timestamp").show(),i(),!1}),e(".save-timestamp","#timestampdiv").click(function(){return i()&&(e("#timestampdiv").slideUp("fast"),e("#timestampdiv").siblings("a.edit-timestamp").show()),!1}),e("#post").on("submit",function(t){return i()?void 0:(t.preventDefault(),e("#timestampdiv").show(),e("#publishing-action .spinner").hide(),e("#publish").prop("disabled",!1).removeClass("button-primary-disabled"),!1)}),e("#post-status-select").siblings("a.edit-post-status").click(function(){return e("#post-status-select").is(":hidden")&&(e("#post-status-select").slideDown("fast"),e(this).hide()),!1}),e(".save-post-status","#post-status-select").click(function(){return e("#post-status-select").slideUp("fast"),e("#post-status-select").siblings("a.edit-post-status").show(),i(),!1}),e(".cancel-post-status","#post-status-select").click(function(){return e("#post-status-select").slideUp("fast"),e("#post_status").val(e("#hidden_post_status").val()),e("#post-status-select").siblings("a.edit-post-status").show(),i(),!1})),e("#edit-slug-box").length&&(editPermalink=function(t){var n,r,i=0,s=e("#editable-post-name"),o=s.html(),u=e("#post_name"),f=u.val(),l=e("#edit-slug-buttons"),c=l.html(),h=e("#editable-post-name-full").html();for(e("#view-post-btn").hide(),l.html('<a href="#" class="save button button-small">'+postL10n.ok+'</a> <a class="cancel" href="#">'+postL10n.cancel+"</a>"),l.children(".save").click(function(){var n=s.children("input").val();return n==e("#editable-post-name-full").text()?e(".cancel","#edit-slug-buttons").click():(e.post(ajaxurl,{action:"sample-permalink",post_id:t,new_slug:n,new_title:e("#title").val(),samplepermalinknonce:e("#samplepermalinknonce").val()},function(t){var r=e("#edit-slug-box");r.html(t),r.hasClass("hidden")&&r.fadeIn("fast",function(){r.removeClass("hidden")}),l.html(c),u.val(n),makeSlugeditClickable(),e("#view-post-btn").show()}),!1)}),e(".cancel","#edit-slug-buttons").click(function(){return e("#view-post-btn").show(),s.html(o),l.html(c),u.val(f),!1}),r=0;r<h.length;++r)"%"==h.charAt(r)&&i++;n=i>h.length/4?"":h,s.html('<input type="text" id="new-post-slug" value="'+n+'" />').children("input").keypress(function(e){var t=e.keyCode||0;return 13==t?(l.children(".save").click(),!1):27==t?(l.children(".cancel").click(),!1):void 0}).keyup(function(){u.val(this.value)}).focus()},makeSlugeditClickable=function(){e("#editable-post-name").click(function(){e("#edit-slug-buttons").children(".edit-slug").click()})},makeSlugeditClickable()),"undefined"!=typeof wpWordCount&&(e(document).triggerHandler("wpcountwords",[u.val()]),u.keyup(function(t){var n=t.keyCode||t.charCode;return n==o?!0:((13==n||8==o||46==o)&&e(document).triggerHandler("wpcountwords",[u.val()]),o=n,!0)})),wptitlehint=function(t){t=t||"title";var n=e("#"+t),r=e("#"+t+"-prompt-text");""===n.val()&&r.removeClass("screen-reader-text"),r.click(function(){e(this).addClass("screen-reader-text"),n.focus()}),n.blur(function(){""===this.value&&r.removeClass("screen-reader-text")}).focus(function(){r.addClass("screen-reader-text")}).keydown(function(t){r.addClass("screen-reader-text"),e(this).unbind(t)})},wptitlehint(),function(){function t(e){return i.height(Math.max(50,s+e.pageY)+"px"),!1}function n(){var r;i.focus(),e(document).unbind("mousemove",t).unbind("mouseup",n),r=parseInt(i.css("height"),10),r&&r>50&&5e3>r&&setUserSetting("ed_size",r)}var r,i=e("textarea#content"),s=null;!i.length||"ontouchstart"in window||(i.css("resize","none"),r=e('<div id="content-resize-handle"><br></div>'),e("#wp-content-wrap").append(r),r.on("mousedown",function(r){return s=i.height()-r.pageY,i.blur(),e(document).mousemove(t).mouseup(n),!1}))}(),"undefined"!=typeof tinymce&&(tinymce.onAddEditor.add(function(t,n){function r(){var t,n=document.getElementById("content_ifr"),r=n?parseInt(n.style.height,10):0,i=e("#content_tbl tr.mceFirst").height();return r&&i?(t=r+i+21,t-=33):!1}"content"!=n.id||tinymce.isIOS5||(n.onLoadContent.add(function(){var t,n=document.getElementById("content"),r=n?parseInt(n.style.height,10):0,i=e("#content_tbl tr.mceFirst").height()||33;(!r||50>r||r>5e3)&&(r=360),getUserSetting("ed_size")>5e3&&setUserSetting("ed_size",360),t=r-i+12,t>50&&5e3>t&&(e("#content_tbl").css("height",""),e("#content_ifr").css("height",t+"px"))}),n.onSaveContent.add(function(){var t=r();!t||50>t||t>5e3||e("textarea#content").css("height",t+"px")}),n.onPostRender.add(function(){e("#content_resize").on("mousedown.wp-mce-resize",function(){e(document).on("mouseup.wp-mce-resize",function(){var t;e(document).off("mouseup.wp-mce-resize"),t=r(),t&&t>50&&5e3>t&&setUserSetting("ed_size",t)})})}))}),e("#post-formats-select input.post-format").on("change.set-editor-class",function(){var t,n,r=this.id;r&&e(this).prop("checked")&&(t=tinymce.get("content"),t&&(n=t.getBody(),n.className=n.className.replace(/\bpost-format-[^ ]+/,""),t.dom.addClass(n,"post-format-0"==r?"post-format-standard":r)))}))});