/* global wpColorPickerL10n:true */(function(e,t){var n,r='<a tabindex="0" class="wp-color-result" />',i='<div class="wp-picker-holder" />',s='<div class="wp-picker-container" />',o='<input type="button" class="button button-small hidden" />';n={options:{defaultColor:!1,change:!1,clear:!1,hide:!0,palettes:!0},_create:function(){if(!e.support.iris)return;var t=this,n=t.element;e.extend(t.options,n.data());t.initialValue=n.val();n.addClass("wp-color-picker").hide().wrap(s);t.wrap=n.parent();t.toggler=e(r).insertBefore(n).css({backgroundColor:t.initialValue}).attr("title",wpColorPickerL10n.pick).attr("data-current",wpColorPickerL10n.current);t.pickerContainer=e(i).insertAfter(n);t.button=e(o);t.options.defaultColor?t.button.addClass("wp-picker-default").val(wpColorPickerL10n.defaultString):t.button.addClass("wp-picker-clear").val(wpColorPickerL10n.clear);n.wrap('<span class="wp-picker-input-wrap" />').after(t.button);n.iris({target:t.pickerContainer,hide:!0,width:255,mode:"hsv",palettes:t.options.palettes,change:function(n,r){t.toggler.css({backgroundColor:r.color.toString()});e.isFunction(t.options.change)&&t.options.change.call(this,n,r)}});n.val(t.initialValue);t._addListeners();t.options.hide||t.toggler.click()},_addListeners:function(){var t=this;t.toggler.click(function(n){n.stopPropagation();t.element.toggle().iris("toggle");t.button.toggleClass("hidden");t.toggler.toggleClass("wp-picker-open");t.toggler.hasClass("wp-picker-open")?e("body").on("click",{wrap:t.wrap,toggler:t.toggler},t._bodyListener):e("body").off("click",t._bodyListener)});t.element.change(function(n){var r=e(this),i=r.val();if(i===""||i==="#"){t.toggler.css("backgroundColor","");e.isFunction(t.options.clear)&&t.options.clear.call(this,n)}});t.toggler.on("keyup",function(e){if(e.keyCode===13||e.keyCode===32){e.preventDefault();t.toggler.trigger("click").next().focus()}});t.button.click(function(n){var r=e(this);if(r.hasClass("wp-picker-clear")){t.element.val("");t.toggler.css("backgroundColor","");e.isFunction(t.options.clear)&&t.options.clear.call(this,n)}else r.hasClass("wp-picker-default")&&t.element.val(t.options.defaultColor).change()})},_bodyListener:function(e){e.data.wrap.find(e.target).length||e.data.toggler.click()},color:function(e){if(e===t)return this.element.iris("option","color");this.element.iris("option","color",e)},defaultColor:function(e){if(e===t)return this.options.defaultColor;this.options.defaultColor=e}};e.widget("wp.wpColorPicker",n)})(jQuery);