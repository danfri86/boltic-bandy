/* global inlineEditL10n, ajaxurl */var inlineEditTax;(function(e){inlineEditTax={init:function(){var t=this,n=e("#inline-edit");t.type=e("#the-list").attr("data-wp-lists").substr(5);t.what="#"+t.type+"-";e("#the-list").on("click","a.editinline",function(){inlineEditTax.edit(this);return!1});n.keyup(function(e){if(e.which===27)return inlineEditTax.revert()});e("a.cancel",n).click(function(){return inlineEditTax.revert()});e("a.save",n).click(function(){return inlineEditTax.save(this)});e("input, select",n).keydown(function(e){if(e.which===13)return inlineEditTax.save(this)});e('#posts-filter input[type="submit"]').mousedown(function(){t.revert()})},toggle:function(t){var n=this;e(n.what+n.getId(t)).css("display")==="none"?n.revert():n.edit(t)},edit:function(t){var n,r,i=this;i.revert();typeof t=="object"&&(t=i.getId(t));n=e("#inline-edit").clone(!0),r=e("#inline_"+t);e("td",n).attr("colspan",e(".widefat:first thead th:visible").length);e(i.what+t).hasClass("alternate")&&e(n).addClass("alternate");e(i.what+t).hide().after(n);e(':input[name="name"]',n).val(e(".name",r).text());e(':input[name="slug"]',n).val(e(".slug",r).text());e(n).attr("id","edit-"+t).addClass("inline-editor").show();e(".ptitle",n).eq(0).focus();return!1},save:function(t){var n,r,i=e('input[name="taxonomy"]').val()||"";typeof t=="object"&&(t=this.getId(t));e("table.widefat .spinner").show();n={action:"inline-save-tax",tax_type:this.type,tax_ID:t,taxonomy:i};r=e("#edit-"+t).find(":input").serialize();n=r+"&"+e.param(n);e.post(ajaxurl,n,function(n){var r,i;e("table.widefat .spinner").hide();if(n)if(-1!==n.indexOf("<tr")){e(inlineEditTax.what+t).remove();i=e(n).attr("id");e("#edit-"+t).before(n).remove();r=i?e("#"+i):e(inlineEditTax.what+t);r.hide().fadeIn()}else e("#edit-"+t+" .inline-edit-save .error").html(n).show();else e("#edit-"+t+" .inline-edit-save .error").html(inlineEditL10n.error).show();e(r).prev("tr").hasClass("alternate")&&e(r).removeClass("alternate")});return!1},revert:function(){var t=e("table.widefat tr.inline-editor").attr("id");if(t){e("table.widefat .spinner").hide();e("#"+t).remove();t=t.substr(t.lastIndexOf("-")+1);e(this.what+t).show()}return!1},getId:function(t){var n=t.tagName==="TR"?t.id:e(t).parents("tr").attr("id"),r=n.split("-");return r[r.length-1]}};e(document).ready(function(){inlineEditTax.init()})})(jQuery);